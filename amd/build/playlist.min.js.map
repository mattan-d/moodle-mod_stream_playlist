{"version":3,"file":"playlist.min.js","sources":["../src/playlist.js"],"sourcesContent":["define([\"jquery\", \"core/ajax\", \"core/str\"], ($, ajax, str) => ({\n  init: () => {\n    $(\".playlist-item\").on(\"click\", function () {\n      var playlistItem = $(this)\n      var container = playlistItem.closest(\".stream-playlist-container\")\n      var mainVideoContainer = container.find(\".stream-main-video\")\n\n      if (playlistItem.hasClass(\"active\")) {\n        return // Don't reload if it's already active.\n      }\n\n      var identifier = playlistItem.data(\"identifier\")\n      var cmid = container.data(\"cmid\")\n      var includeaudio = container.data(\"includeaudio\")\n\n      // Set active state\n      container.find(\".playlist-item\").removeClass(\"active\")\n      playlistItem.addClass(\"active\")\n\n      // Show loading indicator\n      mainVideoContainer.html(\n        '<div class=\"loading-overlay\"><div class=\"spinner-border\" role=\"status\"><span class=\"sr-only\">Loading...</span></div></div>',\n      )\n\n      // Mark as viewed\n      ajax\n        .call([\n          {\n            methodname: \"mod_stream_mark_as_viewed\",\n            args: {\n              cmid: cmid,\n              videoid: identifier,\n            },\n          },\n        ])[0]\n        .done(() => {\n          if (!playlistItem.find(\".playlist-viewed-badge\").length) {\n            str.get_string(\"viewed\", \"mod_stream\").then((viewedString) => {\n              playlistItem\n                .find(\".playlist-item-content\")\n                .append('<span class=\"badge badge-success playlist-viewed-badge\">' + viewedString + \"</span>\")\n            })\n          }\n        })\n\n      // Load player\n      ajax\n        .call([\n          {\n            methodname: \"mod_stream_get_player\",\n            args: {\n              cmid: cmid,\n              identifier: identifier,\n              includeaudio: includeaudio,\n            },\n          },\n        ])[0]\n        .done((response) => {\n          mainVideoContainer.html(response.html)\n        })\n        .fail((ex) => {\n          // Handle error\n          mainVideoContainer.html('<div class=\"alert alert-danger\">Failed to load video.</div>')\n          console.error(ex)\n        })\n    })\n  },\n}))\n"],"names":["define","$","ajax","str","init","on","playlistItem","this","container","closest","mainVideoContainer","find","hasClass","identifier","data","cmid","includeaudio","removeClass","addClass","html","call","methodname","args","videoid","done","length","get_string","then","viewedString","append","response","fail","ex","console","error"],"mappings":"AAAAA,OAAO,sBAAA,CAAC,SAAU,YAAa,YAAa,CAACC,EAAGC,KAAMC,OAAS,CAC7DC,KAAMA,KACJH,EAAE,kBAAkBI,GAAG,QAAS,WAC9B,IAAIC,aAAeL,EAAEM,MACjBC,UAAYF,aAAaG,QAAQ,8BACjCC,mBAAqBF,UAAUG,KAAK,sBAExC,IAAIL,aAAaM,SAAS,UAA1B,CAIA,IAAIC,WAAaP,aAAaQ,KAAK,cAC/BC,KAAOP,UAAUM,KAAK,QACtBE,aAAeR,UAAUM,KAAK,gBAGlCN,UAAUG,KAAK,kBAAkBM,YAAY,UAC7CX,aAAaY,SAAS,UAGtBR,mBAAmBS,KACjB,8HAIFjB,KACGkB,KAAK,CACJ,CACEC,WAAY,4BACZC,KAAM,CACJP,KAAMA,KACNQ,QAASV,eAGZ,GACFW,KAAK,KACClB,aAAaK,KAAK,0BAA0Bc,QAC/CtB,IAAIuB,WAAW,SAAU,cAAcC,KAAMC,eAC3CtB,aACGK,KAAK,0BACLkB,OAAO,2DAA6DD,aAAe,eAM9F1B,KACGkB,KAAK,CACJ,CACEC,WAAY,wBACZC,KAAM,CACJP,KAAMA,KACNF,WAAYA,WACZG,aAAcA,iBAGjB,GACFQ,KAAMM,WACLpB,mBAAmBS,KAAKW,SAASX,QAElCY,KAAMC,KAELtB,mBAAmBS,KAAK,+DACxBc,QAAQC,MAAMF,KAtDlB,CAwDF"}